<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="css/mobile.min.css" rel="stylesheet" />
</head>
<body>
<div class="main">
    <div class="main">
        <h2>Device Orientation</h2>
        <table>
            <tr>
                <td>Event Supported</td>
                <td id="doEvent"></td>
            </tr>
            <tr>
                <td>Tilt Left/Right [gamma]</td>
                <td id="doTiltLR"></td>
            </tr>
            <tr>
                <td>Tilt Front/Back [beta]</td>
                <td id="doTiltFB"></td>
            </tr>
            <tr>
                <td>Direction [alpha]</td>
                <td id="doDirection"></td>
            </tr>
        </table>
    </div>

    <div class="container" style="perspective: 300;">
        <img src="img/testimg.png" id="imgLogo" class="logo">
    </div>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>

        var socket = io(window.location.host);//"http://172.30.18.155:3000");

        if (window.DeviceOrientationEvent) {
            document.getElementById("doEvent").innerHTML = "DeviceOrientation";
            // Listen for the deviceorientation event and handle the raw data
            window.addEventListener('deviceorientation', function(eventData) {
                var gba = {};
                gba.gamma = eventData.gamma;
                gba.beta = eventData.beta;
                gba.alpha = eventData.alpha;
                deviceOrientationHandler(gba.gamma, gba.beta, gba.alpha);
                socket.emit('deviceOrientation', gba);
            }, false);
        } else {
            document.getElementById("doEvent").innerHTML = "Not supported."
        }
        function deviceOrientationHandler(tiltLR, tiltFB, dir){
            document.getElementById("doTiltLR").innerHTML = Math.round(tiltLR);
            document.getElementById("doTiltFB").innerHTML = Math.round(tiltFB);
            document.getElementById("doDirection").innerHTML = Math.round(dir);

            var logo = document.getElementById("imgLogo");
            logo.style.webkitTransform =
                    "rotate("+ tiltLR +"deg) rotate3d(1,0,0, "+ (tiltFB*-1)+"deg)";
            logo.style.MozTransform = "rotate("+ tiltLR +"deg)";
            logo.style.transform =
                    "rotate("+ tiltLR +"deg) rotate3d(1,0,0, "+ (tiltFB*-1)+"deg)";
        }
    </script>
</div>
</body>
</html>