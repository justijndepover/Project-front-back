!function(){angular.module("app",[])}(),function(){var t=function(t,e,n){t.LCShow=n.getLCShow,e.on("startGame",function(t){console.log("start game")}),e.on("roomDisconnect",function(t){n.setPCShow(!1),n.setLCShow(!0)}),t.joinRoom=function(t,n){var o={};o.username=t,o.room=n.toUpperCase(),e.emit("gsmConnect",o)},e.on("message",function(e){switch(e){case"connectionEstablished":n.setPCShow(!0),n.setLCShow(!1);break;case"connectionRefused":t.text="Something went wrong";break;case"usernameExist":t.text="Username already exist";break;case"roomFull":t.text="Room is already full."}})};angular.module("app").controller("loginController",["$scope","socketService","displayService",t])}(),function(){"use strict";var t=function(t,e,n,o,i){t.PCShow=i.getPCShow,t.showSettings=i.getSettingShow,t.life=3,t.getNumber=function(t){return new Array(t)},t.startGame=!1,t.Settings=function(){var t=document.getElementsByClassName("btnSettings")[0].children[0];1==t.classList.contains("rotate")?(i.setSettingShow(!1),t.setAttribute("class","rotateAnti")):(i.setSettingShow(!0),t.setAttribute("class","rotate"))},n.on("roomDisconnect",function(e){t.life=3,delete t.color,delete t.text,t.startGame=!1}),t.shoot=function(){n.emit("playerShot",null)};var a=function(t){var e={};e.beta=t.beta,n.emit("deviceOrientation",e)};o.subscribeMe(),e.$on("app.deviceorientationEvent",function(t,e){a(e)}),t.leaveRoom=function(){n.emit("gsmDisconnect",null),i.setLCShow(!0),i.setPCShow(!1),i.setSettingShow(!1)},n.on("message",function(e){console.log(e),"connectionEstablished"==e?(t.text="Waiting on other players",t.startGame=!1):"startGame"==e?t.startGame=!0:"winner"==e?(t.text="Winner!!",t.startGame=!1):"restartGame"==e&&(t.life=3,t.startGame=!0)}),n.on("color",function(e){t.color=e}),n.on("life",function(e){-1==e?(t.text="Game over",t.startGame=!1):(t.life>e&&"vibrate"in navigator&&navigator.vibrate(200),t.life=e)})};angular.module("app").controller("playController",["$scope","$rootScope","socketService","eventService","displayService",t])}(),function(){var t=function(){var t=!0,e=!1,n=!1;return{getLCShow:function(){return t},setLCShow:function(e){t=e},getPCShow:function(){return e},setPCShow:function(t){e=t},getSettingShow:function(){return n},setSettingShow:function(t){n=t}}};angular.module("app").factory("displayService",[t])}(),function(){var t=function(t,e){function n(){e.addEventListener("deviceorientation",function(e){t.$broadcast("app.deviceorientationEvent",e)})}return{subscribeMe:n}};angular.module("app").factory("eventService",["$rootScope","$window",t])}(),function(){var t=function(t){"use strict";var e=io.connect(window.location.host),n=function(n,o){e.on(n,function(){var n=arguments;t.$apply(function(){o.apply(e,n)})})},o=function(n,o,i){e.emit(n,o,function(){var n=arguments;t.$apply(function(){i&&i.apply(e,n)})})};return{on:n,emit:o,socket:e}};angular.module("app").factory("socketService",["$rootScope",t])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXIvbG9naW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlci9wbGF5Q29udHJvbGxlci5qcyIsInNlcnZpY2VzL2Rpc3BsYXlTZXJ2aWNlLmpzIiwic2VydmljZXMvZXZlbnRTZXJ2aWNlLmpzIiwic2VydmljZXMvc29ja2V0U2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwibG9naW5Db250cm9sbGVyIiwiJHNjb3BlIiwic29ja2V0U2VydmljZSIsImRpc3BsYXlTZXJ2aWNlIiwiTENTaG93IiwiZ2V0TENTaG93Iiwib24iLCJkYXRhIiwiY29uc29sZSIsImxvZyIsInNldFBDU2hvdyIsInNldExDU2hvdyIsImpvaW5Sb29tIiwidXNlcm5hbWUiLCJyb29tIiwidG9VcHBlckNhc2UiLCJlbWl0IiwibWVzc2FnZSIsInRleHQiLCJjb250cm9sbGVyIiwicGxheUNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiZXZlbnRTZXJ2aWNlIiwiUENTaG93IiwiZ2V0UENTaG93Iiwic2hvd1NldHRpbmdzIiwiZ2V0U2V0dGluZ1Nob3ciLCJsaWZlIiwiZ2V0TnVtYmVyIiwibnVtIiwiQXJyYXkiLCJzdGFydEdhbWUiLCJTZXR0aW5ncyIsImJ0biIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImNoaWxkcmVuIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJzZXRTZXR0aW5nU2hvdyIsInNldEF0dHJpYnV0ZSIsImNvbG9yIiwic2hvb3QiLCJzZW5kRGV2aWNlT3JpZW50YXRpb24iLCJldmVudERhdGEiLCJiZXRhIiwic3Vic2NyaWJlTWUiLCIkb24iLCJhIiwiYiIsImxlYXZlUm9vbSIsIm5hdmlnYXRvciIsInZpYnJhdGUiLCJTZXR0aW5nU2hvdyIsInZhbHVlIiwiZmFjdG9yeSIsIiR3aW5kb3ciLCJzdWJzRnVuYyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiJGJyb2FkY2FzdCIsInNvY2tldCIsImlvIiwiY29ubmVjdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdCIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwiYXJncyIsImFyZ3VtZW50cyIsIiRhcHBseSIsImFwcGx5Il0sIm1hcHBpbmdzIjoiQ0FHQSxXQUVBQSxRQUFBQyxPQUFBLGFDQUEsV0FFQSxHQUFBQyxHQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FGLEVBQUFHLE9BQUFELEVBQUFFLFVBRUFILEVBQUFJLEdBQUEsWUFBQSxTQUFBQyxHQUNBQyxRQUFBQyxJQUFBLGdCQUVBUCxFQUFBSSxHQUFBLGlCQUFBLFNBQUFDLEdBQ0FKLEVBQUFPLFdBQUEsR0FDQVAsRUFBQVEsV0FBQSxLQUdBVixFQUFBVyxTQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQVAsS0FDQUEsR0FBQU0sU0FBQUEsRUFDQU4sRUFBQU8sS0FBQUEsRUFBQUMsY0FDQWIsRUFBQWMsS0FBQSxhQUFBVCxJQUlBTCxFQUFBSSxHQUFBLFVBQUEsU0FBQVcsR0FDQSxPQUFBQSxHQUNBLElBQUEsd0JBQ0FkLEVBQUFPLFdBQUEsR0FDQVAsRUFBQVEsV0FBQSxFQUNBLE1BQ0EsS0FBQSxvQkFDQVYsRUFBQWlCLEtBQUEsc0JBQ0EsTUFDQSxLQUFBLGdCQUNBakIsRUFBQWlCLEtBQUEsd0JBQ0EsTUFDQSxLQUFBLFdBQ0FqQixFQUFBaUIsS0FBQSwyQkFRQXBCLFNBQUFDLE9BQUEsT0FBQW9CLFdBQUEsbUJBQUEsU0FBQSxnQkFBQSxpQkFBQW5CLE9DMUNBLFdBQ0EsWUFDQSxJQUFBb0IsR0FBQSxTQUFBbkIsRUFBQW9CLEVBQUFuQixFQUFBb0IsRUFBQW5CLEdBQ0FGLEVBQUFzQixPQUFBcEIsRUFBQXFCLFVBQ0F2QixFQUFBd0IsYUFBQXRCLEVBQUF1QixlQUNBekIsRUFBQTBCLEtBQUEsRUFDQTFCLEVBQUEyQixVQUFBLFNBQUFDLEdBQ0EsTUFBQSxJQUFBQyxPQUFBRCxJQUVBNUIsRUFBQThCLFdBQUEsRUFDQTlCLEVBQUErQixTQUFBLFdBQ0EsR0FBQUMsR0FBQUMs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QUFBLEdBSUEvRCxTQUFBQyxPQUFBLE9BQUF3RCxRQUFBLGlCQUFBLGFBQUFyRCIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IE1pY2hpZWwgb24gMjUvMTEvMjAxNS5cbiAqL1xuKGZ1bmN0aW9uKCl7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoXCJhcHBcIixbXSk7XG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGp1c3Rpam5kZXBvdmVyIG9uIDE2LzEyLzE1LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICB2YXIgbG9naW5Db250cm9sbGVyID0gZnVuY3Rpb24oJHNjb3BlLCBzb2NrZXRTZXJ2aWNlLCBkaXNwbGF5U2VydmljZSl7XHJcbiAgICAgICAgJHNjb3BlLkxDU2hvdyA9IGRpc3BsYXlTZXJ2aWNlLmdldExDU2hvdztcclxuICAgICAgICAvL2Z1bmN0aW9uc1xyXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJzdGFydEdhbWVcIiwgZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdGFydCBnYW1lXCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJyb29tRGlzY29ubmVjdFwiLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBkaXNwbGF5U2VydmljZS5zZXRQQ1Nob3coZmFsc2UpO1xyXG4gICAgICAgICAgICBkaXNwbGF5U2VydmljZS5zZXRMQ1Nob3codHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5qb2luUm9vbSA9IGZ1bmN0aW9uKHVzZXJuYW1lLCByb29tKXtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICAgICAgZGF0YS51c2VybmFtZSA9IHVzZXJuYW1lO1xyXG4gICAgICAgICAgICBkYXRhLnJvb20gPSByb29tLnRvVXBwZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIHNvY2tldFNlcnZpY2UuZW1pdChcImdzbUNvbm5lY3RcIiwgZGF0YSk7XHJcblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJtZXNzYWdlXCIsIGZ1bmN0aW9uKG1lc3NhZ2Upe1xyXG4gICAgICAgICAgICBzd2l0Y2gobWVzc2FnZSl7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiY29ubmVjdGlvbkVzdGFibGlzaGVkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheVNlcnZpY2Uuc2V0UENTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlTZXJ2aWNlLnNldExDU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiY29ubmVjdGlvblJlZnVzZWRcIjpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dCA9IFwiU29tZXRoaW5nIHdlbnQgd3JvbmdcIjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ1c2VybmFtZUV4aXN0XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRleHQgPSBcIlVzZXJuYW1lIGFscmVhZHkgZXhpc3RcIjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJyb29tRnVsbFwiIDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudGV4dCA9IFwiUm9vbSBpcyBhbHJlYWR5IGZ1bGwuXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0IDpcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcFwiKS5jb250cm9sbGVyKFwibG9naW5Db250cm9sbGVyXCIsIFtcIiRzY29wZVwiLCBcInNvY2tldFNlcnZpY2VcIiwgXCJkaXNwbGF5U2VydmljZVwiLCBsb2dpbkNvbnRyb2xsZXJdKTtcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAxNi8xMi8xNS5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHZhciBwbGF5Q29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgc29ja2V0U2VydmljZSwgZXZlbnRTZXJ2aWNlLCBkaXNwbGF5U2VydmljZSl7XHJcbiAgICAgICAgJHNjb3BlLlBDU2hvdyA9IGRpc3BsYXlTZXJ2aWNlLmdldFBDU2hvdztcclxuICAgICAgICAkc2NvcGUuc2hvd1NldHRpbmdzID0gZGlzcGxheVNlcnZpY2UuZ2V0U2V0dGluZ1Nob3c7XHJcbiAgICAgICAgJHNjb3BlLmxpZmU9MztcclxuICAgICAgICAkc2NvcGUuZ2V0TnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXkobnVtKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGFydEdhbWUgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuU2V0dGluZ3MgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICB2YXIgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYnRuU2V0dGluZ3MnKVswXS5jaGlsZHJlblswXTtcclxuICAgICAgICAgICAgaWYoYnRuLmNsYXNzTGlzdC5jb250YWlucygncm90YXRlJyk9PXRydWUpe1xyXG4gICAgICAgICAgICAgICAgZGlzcGxheVNlcnZpY2Uuc2V0U2V0dGluZ1Nob3coZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAncm90YXRlQW50aScpO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlTZXJ2aWNlLnNldFNldHRpbmdTaG93KHRydWUpO1xyXG4gICAgICAgICAgICAgICAgYnRuLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAncm90YXRlJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgc29ja2V0U2VydmljZS5vbihcInJvb21EaXNjb25uZWN0XCIsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5saWZlPTM7XHJcbiAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUuY29sb3I7XHJcbiAgICAgICAgICAgIGRlbGV0ZSAkc2NvcGUudGV4dDtcclxuICAgICAgICAgICAgJHNjb3BlLnN0YXJ0R2FtZT1mYWxzZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNob290ID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgc29ja2V0U2VydmljZS5lbWl0KFwicGxheWVyU2hvdFwiLCBudWxsKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc2VuZERldmljZU9yaWVudGF0aW9uID0gZnVuY3Rpb24oZXZlbnREYXRhKXtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcclxuICAgICAgICAgICAgLy9kYXRhLmdhbW1hID0gZXZlbnREYXRhLmdhbW1hO1xyXG4gICAgICAgICAgICBkYXRhLmJldGEgPSBldmVudERhdGEuYmV0YTtcclxuICAgICAgICAgICAgLy9kYXRhLmFscGhhID0gZXZlbnREYXRhLmFscGhhO1xyXG4gICAgICAgICAgICBzb2NrZXRTZXJ2aWNlLmVtaXQoXCJkZXZpY2VPcmllbnRhdGlvblwiLCBkYXRhKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZXZlbnRTZXJ2aWNlLnN1YnNjcmliZU1lKCk7XHJcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJ2FwcC5kZXZpY2VvcmllbnRhdGlvbkV2ZW50JywgZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICBzZW5kRGV2aWNlT3JpZW50YXRpb24oYik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5sZWF2ZVJvb20gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzb2NrZXRTZXJ2aWNlLmVtaXQoXCJnc21EaXNjb25uZWN0XCIsIG51bGwpO1xyXG4gICAgICAgICAgICBkaXNwbGF5U2VydmljZS5zZXRMQ1Nob3codHJ1ZSk7XHJcbiAgICAgICAgICAgIGRpc3BsYXlTZXJ2aWNlLnNldFBDU2hvdyhmYWxzZSk7XHJcbiAgICAgICAgICAgIGRpc3BsYXlTZXJ2aWNlLnNldFNldHRpbmdTaG93KGZhbHNlKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBzb2NrZXRTZXJ2aWNlLm9uKFwibWVzc2FnZVwiLCBmdW5jdGlvbihtZXNzYWdlKXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIGlmKG1lc3NhZ2UgPT0gXCJjb25uZWN0aW9uRXN0YWJsaXNoZWRcIil7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudGV4dCA9IFwiV2FpdGluZyBvbiBvdGhlciBwbGF5ZXJzXCI7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnRHYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1lbHNlIGlmKG1lc3NhZ2UgPT0gXCJzdGFydEdhbWVcIil7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RhcnRHYW1lID0gdHJ1ZTtcclxuICAgICAgICAgICAgfWVsc2UgaWYgKG1lc3NhZ2UgPT0gXCJ3aW5uZXJcIil7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudGV4dCA9IFwiV2lubmVyISFcIjtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdGFydEdhbWUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmKG1lc3NhZ2U9PSBcInJlc3RhcnRHYW1lXCIpe1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmxpZmU9MztcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdGFydEdhbWUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJjb2xvclwiLCBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29sb3I9ZGF0YTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgc29ja2V0U2VydmljZS5vbihcImxpZmVcIixmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgaWYoZGF0YT09LTEpe1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRleHQgPSBcIkdhbWUgb3ZlclwiO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXJ0R2FtZT1mYWxzZTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBpZigkc2NvcGUubGlmZT5kYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICBpZigndmlicmF0ZScgaW4gbmF2aWdhdG9yKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLnZpYnJhdGUoMjAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubGlmZSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJwbGF5Q29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwic29ja2V0U2VydmljZVwiLCBcImV2ZW50U2VydmljZVwiLCBcImRpc3BsYXlTZXJ2aWNlXCIsIHBsYXlDb250cm9sbGVyXSlcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAxNi8xMi8xNS5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgZGlzcGxheVNlcnZpY2UgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIC8vTG9naW4gQ29udHJvbGxlclxyXG4gICAgICAgIHZhciBMQ1Nob3cgPSB0cnVlO1xyXG4gICAgICAgIC8vUGxheSBjb250cm9sbGVyXHJcbiAgICAgICAgdmFyIFBDU2hvdyA9IGZhbHNlO1xyXG5cclxuICAgICAgICB2YXIgU2V0dGluZ1Nob3cgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcmV0dXJue1xyXG4gICAgICAgICAgICBnZXRMQ1Nob3c6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gTENTaG93O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXRMQ1Nob3c6IGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgICAgIExDU2hvdyA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXRQQ1Nob3c6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUENTaG93O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXRQQ1Nob3c6IGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgICAgIFBDU2hvdyA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXRTZXR0aW5nU2hvdzogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBTZXR0aW5nU2hvdztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0U2V0dGluZ1Nob3c6IGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgICAgIFNldHRpbmdTaG93ID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgnZGlzcGxheVNlcnZpY2UnLCBbZGlzcGxheVNlcnZpY2VdKTtcclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBNaWNoaWVsIG9uIDE2LzEyLzIwMTUuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuICAgIHZhciBldmVudFNlcnZpY2UgPSBmdW5jdGlvbigkcm9vdFNjb3BlLCR3aW5kb3cpe1xyXG4gICAgICAgIGZ1bmN0aW9uIHN1YnNGdW5jKCkge1xyXG4gICAgICAgICAgICAkd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RldmljZW9yaWVudGF0aW9uJywgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdhcHAuZGV2aWNlb3JpZW50YXRpb25FdmVudCcsIGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgXCJzdWJzY3JpYmVNZVwiOiBzdWJzRnVuY1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcFwiKS5mYWN0b3J5KFwiZXZlbnRTZXJ2aWNlXCIsIFtcIiRyb290U2NvcGVcIixcIiR3aW5kb3dcIiwgZXZlbnRTZXJ2aWNlXSk7XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkganVzdGlqbmRlcG92ZXIgb24gMDkvMTIvMTUuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmFyIHNvY2tldFNlcnZpY2UgPSBmdW5jdGlvbigkcm9vdFNjb3BlKXtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAvL3ByaXZhdGVcclxuICAgICAgICB2YXIgc29ja2V0ID0gaW8uY29ubmVjdCh3aW5kb3cubG9jYXRpb24uaG9zdCk7XHJcbiAgICAgICAgLy9mdW5jdGlvbnNcclxuICAgICAgICB2YXIgb24gPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBzb2NrZXQub24oZXZlbnROYW1lLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShzb2NrZXQsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBlbWl0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgc29ja2V0LmVtaXQoZXZlbnROYW1lLCBkYXRhLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkoc29ja2V0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL3B1YmxpY1xyXG4gICAgICAgIHJldHVybntcclxuICAgICAgICAgICAgb246IG9uLFxyXG4gICAgICAgICAgICBlbWl0OiBlbWl0LFxyXG4gICAgICAgICAgICBzb2NrZXQ6IHNvY2tldFxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHBcIikuZmFjdG9yeShcInNvY2tldFNlcnZpY2VcIiwgW1wiJHJvb3RTY29wZVwiLCBzb2NrZXRTZXJ2aWNlXSk7XHJcblxyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
