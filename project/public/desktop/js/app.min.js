!function(){angular.module("app",[])}(),function(){var t=function(t){function e(e,a,i){t.innerWidth<t.innerHeight?e.width=t.innerWidth-20:e.width=t.innerHeight-20,angular.element(t).bind("resize",function(){t.innerWidth<t.innerHeight?e.width=t.innerWidth-20:e.width=t.innerHeight-20,e.$digest()})}return{restrict:"E",link:e,replace:!0,template:'<canvas id="game" class="playArea" width="{{width}}" height="{{width}}" />'}};angular.module("app").directive("canvasDirective",["$window",t])}(),function(){var t=function(t,e,a,i){t.LCShow=a.getLCShow;var n=function(){e.emit("pcconnect",null)};t.room="",e.on("requestRoom",function(e){t.room=e}),e.on("deviceOrientation",function(t){var e=(t.username,{});e.gamma=t.gamma,e.beta=t.beta,e.alpha=t.alpha}),t.usernames={},t.checkUserCount=!1,e.on("updateusers",function(e){console.log(e),i.setPlayers(e),t.usernames=e,t.checkUserCount=Object.keys(t.usernames).length<0}),t.startGame=function(){e.emit("startGame",null),a.setLCShow(!1),a.setPCShow(!0)},function(){n()}()};angular.module("app").controller("loginController",["$scope","socketService","displayService","playerService",t])}(),function(){"use strict";var t=function(t,e,a,i,n,o){function r(t,e){return e.username==t.userName?!0:!1}function s(){u.clearRect(0,0,h.width,h.height);var t=h.width/100;if(0!=l.length){var e=h.width/100,a=e*l[0].image.height/l[0].image.width;for(var i in l){var n=l[i];u.save(),u.translate(n.x*t,n.y*t),u.rotate(n.rotation/180*Math.PI),u.drawImage(n.image,-e/2,-a/2,e,a),u.restore(),l[i].x=Math.cos((n.rotation-90)/180*Math.PI)+n.x,l[i].y=Math.sin((n.rotation-90)/180*Math.PI)+n.y}}if(0!=p.length){var o=h.width/20,r=o*p[0].image.height/p[0].image.width;for(var s in p){var c=p[s];u.save(),u.translate(c.x*t,c.y*t),u.rotate(c.rotation/180*Math.PI),u.drawImage(c.image,-o/2,-r/2,o,r),u.restore(),p[s].x=Math.cos((c.rotation-90)/180*Math.PI)/10*c.speed+c.x,p[s].y=Math.sin((c.rotation-90)/180*Math.PI)/10*c.speed+c.y}}}t.PCShow=n.getPCShow,t.startGame=!1;var c,h=document.getElementById("game"),u=h.getContext("2d"),p=new Array,l=new Array;i.on("initGame",function(){var t=o.getPlayers();for(var a in t){var i=t[a];p.push(new Spaceship(i.username,i.x,i.y,i.color,i.rotation))}c=e(s,10),console.log(p)}),i.on("updateGameData",function(t){var e=null;for(var a in p)1==r(p[a],t)&&(e=a);null!=e&&p[e].rotateSpaceshipRelative(t.orientation)}),i.on("playerShot",function(t){var e=null;for(var a in p)1==r(p[a],t)&&(e=a);if(null!=e){var i=p[e];l.push(new Bullet(i.x,i.y,i.rotation,i.color))}})};angular.module("app").controller("playController",["$scope","$interval","$window","socketService","displayService","playerService",t])}();var Bullet=function(t,e,a,i){this.x=t,this.y=e,this.rotation=a,this.image=new Image,this.color=i,"orange"==this.color&&(this.color="red"),this.image.src="../assets/PNG/Lasers/laser"+this.color.charAt(0).toUpperCase()+this.color.slice(1)+"01.png"},Spaceship=function(t,e,a,i,n){this.userName=t,this.x=e,this.y=a,this.speed=1,this.color=i,this.rotation=n,this.image=new Image,this.damage=0,this.damageImage=new Image,this.image.src="../assets/PNG/playerShip1_"+this.color+".png"};Spaceship.prototype.moveSpaceship=function(t,e){this.x=t,this.y=e},Spaceship.prototype.moveSpaceshipRelative=function(t,e){this.x=this.x+t,this.y=this.y+e},Spaceship.prototype.rotateSpaceship=function(t){this.rotation=t},Spaceship.prototype.rotateSpaceshipRelative=function(t){this.rotation=this.rotation+t/5,this.rotation<-360&&(this.rotation=this.rotation+720),this.rotation>360&&(this.rotation=this.rotation-720)},Spaceship.prototype.increaseDamage=function(){this.damage<4&&(this.damage+=1),this.damage<=3&&this.damage>0&&(this.damageImage.src="../assets/PNG/Damage/playerShip1_damage"+this.damage+".png")},Spaceship.prototype.increaseDamage=function(){this.damage>0&&(this.damage-=1),this.damage<=3&&this.damage>0&&(this.damageImage.src="../assets/PNG/Damage/playerShip1_damage"+this.damage+".png")},function(){var t=function(){var t=!0,e=!1;return{getLCShow:function(){return t},setLCShow:function(e){t=e},getPCShow:function(){return e},setPCShow:function(t){e=t}}};angular.module("app").factory("displayService",[t])}(),function(){var t=function(){var t=[];return{getPlayers:function(){return t},setPlayers:function(e){t=e}}};angular.module("app").factory("playerService",[t])}(),function(){var t=function(t){"use strict";var e=io.connect(window.location.host),a=function(a,i){e.on(a,function(){var a=arguments;t.$apply(function(){i.apply(e,a)})})},i=function(a,i,n){e.emit(a,i,function(){var a=arguments;t.$apply(function(){n&&n.apply(e,a)})})};return{on:a,emit:i,socket:e}};angular.module("app").factory("socketService",["$rootScope",t])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImRpcmVjdGl2ZXMvY2FudmFzRGlyZWN0aXZlLmpzIiwiY29udHJvbGxlci9sb2dpbkNvbnRyb2xsZXIuanMiLCJjb250cm9sbGVyL3BsYXlDb250cm9sbGVyLmpzIiwibW9kZWxzL0J1bGxldC5qcyIsIm1vZGVscy9TcGFjZXNoaXAuanMiLCJzZXJ2aWNlcy9kaXNwbGF5U2VydmljZS5qcyIsInNlcnZpY2VzL3BsYXllclNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NrZXRTZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjYW52YXNEaXJlY3RpdmUiLCIkd2luZG93IiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0Iiwid2lkdGgiLCJiaW5kIiwiJGRpZ2VzdCIsInJlc3RyaWN0IiwicmVwbGFjZSIsInRlbXBsYXRlIiwiZGlyZWN0aXZlIiwibG9naW5Db250cm9sbGVyIiwiJHNjb3BlIiwic29ja2V0U2VydmljZSIsImRpc3BsYXlTZXJ2aWNlIiwicGxheWVyU2VydmljZSIsIkxDU2hvdyIsImdldExDU2hvdyIsIm1ha2VSb29tIiwiZW1pdCIsInJvb20iLCJvbiIsImRhdGEiLCJkZXZpY2VPcmllbnRhdGlvbiIsInVzZXJuYW1lIiwiZ2FtbWEiLCJiZXRhIiwiYWxwaGEiLCJ1c2VybmFtZXMiLCJjaGVja1VzZXJDb3VudCIsImNvbnNvbGUiLCJsb2ciLCJzZXRQbGF5ZXJzIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInN0YXJ0R2FtZSIsInNldExDU2hvdyIsInNldFBDU2hvdyIsImNvbnRyb2xsZXIiLCJwbGF5Q29udHJvbGxlciIsIiRpbnRlcnZhbCIsImZpbHRlclBsYXllcnMiLCJvYmoiLCJ1c2VyTmFtZSIsImRyYXciLCJjdHgiLCJjbGVhclJlY3QiLCJjYW52IiwiaGVpZ2h0IiwicmF0aW8iLCJBbGxCdWxsZXRzIiwiQnVsbGV0V2lkdGgiLCJCdWxsZXRIZWlnaHQiLCJpbWFnZSIsImJ1bGxldCIsImIiLCJzYXZlIiwidHJhbnNsYXRlIiwieCIsInkiLCJyb3RhdGUiLCJyb3RhdGlvbiIsIk1hdGgiLCJQSSIsImRyYXdJbWFnZSIsInJlc3RvcmUiLCJjb3MiLCJzaW4iLCJBbGxQbGF5ZXJzIiwiU3BhY2VzaGlwV2lkdGgiLCJTcGFjZXNoaXBIZWlnaHQiLCJwbGF5ZXIiLCJwIiwic3BlZWQiLCJQQ1Nob3ciLCJnZXRQQ1Nob3ciLCJjeWNsZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0IiwiQXJyYXkiLCJCdWZmZXJQbGF5ZXIiLCJnZXRQbGF5ZXJzIiwicHVzaCIsIlNwYWNlc2hpcCIsImNvbG9yIiwiaSIsInJvdGF0ZVNwYWNlc2hpcFJlbGF0aXZlIiwib3JpZW50YXRpb24iLCJ0ZW1wIiwiQnVsbGV0IiwidGhpcyIsIkltYWdlIiwic3JjIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsImRhbWFnZSIsImRhbWFnZUltYWdlIiwicHJvdG90eXBlIiwibW92ZVNwYWNlc2hpcCIsIm1vdmVTcGFjZXNoaXBSZWxhdGl2ZSIsInJvdGF0ZVNwYWNlc2hpcCIsImRlZ3JlZSIsImluY3JlYXNlRGFtYWdlIiwidmFsdWUiLCJmYWN0b3J5IiwicGxheWVycyIsInBsYXllcnNBcnJheSIsIiRyb290U2NvcGUiLCJzb2NrZXQiLCJpbyIsImNvbm5lY3QiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhvc3QiLCJldmVudE5hbWUiLCJjYWxsYmFjayIsImFyZ3MiLCJhcmd1bWVudHMiLCIkYXBwbHkiLCJhcHBseSJdLCJtYXBwaW5ncyI6IkNBR0EsV0FFQUEsUUFBQUMsT0FBQSxhQ0ZBLFdBQ0EsR0FBQUMsR0FBQSxTQUFBQyxHQVFBLFFBQUFDLEdBQUFDLEVBQUFDLEVBQUFDLEdBQ0FKLEVBQUFLLFdBQUFMLEVBQUFNLFlBQ0FKLEVBQUFLLE1BQUFQLEVBQUFLLFdBQUEsR0FFQUgsRUFBQUssTUFBQVAsRUFBQU0sWUFBQSxH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QUFpRyxHQUNBLFlBRUEsSUFBQUMsR0FBQUMsR0FBQUMsUUFBQUMsT0FBQUMsU0FBQUMsTUFFQS9GLEVBQUEsU0FBQWdHLEVBQUFDLEdBQ0FQLEVBQUExRixHQUFBZ0csRUFBQSxXQUNBLEdBQUFFLEdBQUFDLFNBQ0FWLEdBQUFXLE9BQUEsV0FDQUgsRUFBQUksTUFBQVgsRUFBQVEsUUFLQXBHLEVBQUEsU0FBQWtHLEVBQUEvRixFQUFBZ0csR0FDQVAsRUFBQTVGLEtBQUFrRyxFQUFBL0YsRUFBQSxXQUNBLEdBQUFpRyxHQUFBQyxTQUNBVixHQUFBVyxPQUFBLFdBQ0FILEdBQ0FBLEVBQUFJLE1BQUFYLEVBQUFRLE9BT0EsUUFDQWxHLEdBQUFBLEVBQ0FGLEtBQUFBLEVBQ0E0RixPQUFBQSxHQUlBckgsU0FBQUMsT0FBQSxPQUFBZ0gsUUFBQSxpQkFBQSxhQUFBOUYiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBNaWNoaWVsIG9uIDI1LzExLzIwMTUuXG4gKi9cbihmdW5jdGlvbigpe1xuXG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIsW10pO1xufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAxNi8xMi8xNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG4gICAgdmFyIGNhbnZhc0RpcmVjdGl2ZSA9IGZ1bmN0aW9uKCR3aW5kb3cpe1xyXG4gICAgICAgIHJldHVybntcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFJyxcclxuICAgICAgICAgICAgbGluazpsaW5rLFxyXG4gICAgICAgICAgICByZXBsYWNlOnRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlOic8Y2FudmFzIGlkPVwiZ2FtZVwiIGNsYXNzPVwicGxheUFyZWFcIiB3aWR0aD1cInt7d2lkdGh9fVwiIGhlaWdodD1cInt7d2lkdGh9fVwiIC8+J1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKXtcclxuICAgICAgICAgICAgaWYoJHdpbmRvdy5pbm5lcldpZHRoIDwgJHdpbmRvdy5pbm5lckhlaWdodCl7XHJcbiAgICAgICAgICAgICAgICBzY29wZS53aWR0aCA9ICR3aW5kb3cuaW5uZXJXaWR0aCAtIDIwO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHNjb3BlLndpZHRoID0gJHdpbmRvdy5pbm5lckhlaWdodCAtIDIwO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykuYmluZCgncmVzaXplJywgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmKCR3aW5kb3cuaW5uZXJXaWR0aCA8ICR3aW5kb3cuaW5uZXJIZWlnaHQpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLndpZHRoID0gJHdpbmRvdy5pbm5lcldpZHRoIC0gMjA7XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS53aWR0aCA9ICR3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzY29wZS4kZGlnZXN0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZShcImNhbnZhc0RpcmVjdGl2ZVwiLCBbXCIkd2luZG93XCIsIGNhbnZhc0RpcmVjdGl2ZV0pO1xyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IE1pY2hpZWwgb24gMTEvMTIvMjAxNS5cclxuICovXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuICAgIHZhciBsb2dpbkNvbnRyb2xsZXIgPSBmdW5jdGlvbigkc2NvcGUsIHNvY2tldFNlcnZpY2UsIGRpc3BsYXlTZXJ2aWNlLCBwbGF5ZXJTZXJ2aWNlKXtcclxuXHJcbiAgICAgICAgJHNjb3BlLkxDU2hvdyA9IGRpc3BsYXlTZXJ2aWNlLmdldExDU2hvdztcclxuXHJcbiAgICAgICAgLy9mdW5jdGlvbnNcclxuICAgICAgICB2YXIgbWFrZVJvb20gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzb2NrZXRTZXJ2aWNlLmVtaXQoXCJwY2Nvbm5lY3RcIiwgbnVsbCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucm9vbSA9IFwiXCI7XHJcbiAgICAgICAgc29ja2V0U2VydmljZS5vbigncmVxdWVzdFJvb20nLGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAkc2NvcGUucm9vbSA9IGRhdGE7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc29ja2V0U2VydmljZS5vbignZGV2aWNlT3JpZW50YXRpb24nLCBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgdmFyIHVzZXJuYW1lID0gZGF0YS51c2VybmFtZTtcclxuICAgICAgICAgICAgdmFyIGRldmljZU9yaWVudGF0aW9uID0ge307XHJcbiAgICAgICAgICAgIGRldmljZU9yaWVudGF0aW9uLmdhbW1hID0gZGF0YS5nYW1tYTtcclxuICAgICAgICAgICAgZGV2aWNlT3JpZW50YXRpb24uYmV0YSA9IGRhdGEuYmV0YTtcclxuICAgICAgICAgICAgZGV2aWNlT3JpZW50YXRpb24uYWxwaGEgPSBkYXRhLmFscGhhO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICRzY29wZS51c2VybmFtZXMgPSB7fTtcclxuICAgICAgICAkc2NvcGUuY2hlY2tVc2VyQ291bnQgPSBmYWxzZTtcclxuICAgICAgICBzb2NrZXRTZXJ2aWNlLm9uKCd1cGRhdGV1c2VycycsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICBwbGF5ZXJTZXJ2aWNlLnNldFBsYXllcnMoZGF0YSk7XHJcbiAgICAgICAgICAgICRzY29wZS51c2VybmFtZXMgPSBkYXRhO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2hlY2tVc2VyQ291bnQgPSBPYmplY3Qua2V5cygkc2NvcGUudXNlcm5hbWVzKS5sZW5ndGggPCAwO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuc3RhcnRHYW1lPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHNvY2tldFNlcnZpY2UuZW1pdChcInN0YXJ0R2FtZVwiLCBudWxsKTtcclxuICAgICAgICAgICAgZGlzcGxheVNlcnZpY2Uuc2V0TENTaG93KGZhbHNlKTtcclxuICAgICAgICAgICAgZGlzcGxheVNlcnZpY2Uuc2V0UENTaG93KHRydWUpO1xyXG4gICAgICAgIH07XHJcblxyXG5cclxuICAgICAgICAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIG1ha2VSb29tKCk7XHJcbiAgICAgICAgfSkoKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJsb2dpbkNvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwic29ja2V0U2VydmljZVwiICwgXCJkaXNwbGF5U2VydmljZVwiLCBcInBsYXllclNlcnZpY2VcIiwgbG9naW5Db250cm9sbGVyXSk7XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgTWljaGllbCBvbiAxNi8xMi8yMDE1LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbigpe1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICB2YXIgcGxheUNvbnRyb2xsZXIgPSBmdW5jdGlvbigkc2NvcGUsICRpbnRlcnZhbCwgJHdpbmRvdywgc29ja2V0U2VydmljZSwgZGlzcGxheVNlcnZpY2UsIHBsYXllclNlcnZpY2Upe1xyXG4gICAgICAgICRzY29wZS5QQ1Nob3cgPSBkaXNwbGF5U2VydmljZS5nZXRQQ1Nob3c7XHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0R2FtZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBjYW52ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUnKTtcclxuICAgICAgICB2YXIgY3R4ID0gY2Fudi5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgICAgICB2YXIgQWxsUGxheWVycyA9IG5ldyBBcnJheSgpO1xyXG4gICAgICAgIHZhciBBbGxCdWxsZXRzID0gbmV3IEFycmF5KCk7XHJcblxyXG4gICAgICAgIHZhciBjeWNsZTtcclxuXHJcbiAgICAgICAgc29ja2V0U2VydmljZS5vbihcImluaXRHYW1lXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHZhciBCdWZmZXJQbGF5ZXIgPSBwbGF5ZXJTZXJ2aWNlLmdldFBsYXllcnMoKTtcclxuICAgICAgICAgICAgZm9yKHZhciBwbGF5ZXIgaW4gQnVmZmVyUGxheWVyKXtcclxuICAgICAgICAgICAgICAgIHZhciBwID0gQnVmZmVyUGxheWVyW3BsYXllcl07XHJcbiAgICAgICAgICAgICAgICBBbGxQbGF5ZXJzLnB1c2gobmV3IFNwYWNlc2hpcChwLnVzZXJuYW1lLCBwLngsIHAueSwgcC5jb2xvciwgcC5yb3RhdGlvbikpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjeWNsZSA9ICRpbnRlcnZhbChkcmF3LCAxMCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEFsbFBsYXllcnMpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzb2NrZXRTZXJ2aWNlLm9uKFwidXBkYXRlR2FtZURhdGFcIiwgZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIHZhciBwID0gbnVsbDtcclxuICAgICAgICAgICAgZm9yKHZhciBpIGluIEFsbFBsYXllcnMpe1xyXG4gICAgICAgICAgICAgICAgaWYoZmlsdGVyUGxheWVycyhBbGxQbGF5ZXJzW2ldLGRhdGEpID09IHRydWUpe1xyXG4gICAgICAgICAgICAgICAgICAgIHAgPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKHAgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgICAgICBBbGxQbGF5ZXJzW3BdLnJvdGF0ZVNwYWNlc2hpcFJlbGF0aXZlKGRhdGEub3JpZW50YXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJwbGF5ZXJTaG90XCIsIGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICB2YXIgcCA9IG51bGw7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaSBpbiBBbGxQbGF5ZXJzKXtcclxuICAgICAgICAgICAgICAgIGlmKGZpbHRlclBsYXllcnMoQWxsUGxheWVyc1tpXSxkYXRhKSA9PSB0cnVlKXtcclxuICAgICAgICAgICAgICAgICAgICBwID0gaTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZihwICE9IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBBbGxQbGF5ZXJzW3BdO1xyXG4gICAgICAgICAgICAgICAgLy92YXIgeCAgPSBNYXRoLnNpbigodGVtcC5yb3RhdGlvbiAtIDkwKS8xODAqTWF0aC5QSSkrdGVtcC54O1xyXG4gICAgICAgICAgICAgICAgLy92YXIgeSA9IE1hdGguY29zKCh0ZW1wLnJvdGF0aW9uIC0gOTApLzE4MCpNYXRoLlBJKSt0ZW1wLnk7XHJcbiAgICAgICAgICAgICAgICBBbGxCdWxsZXRzLnB1c2gobmV3IEJ1bGxldCh0ZW1wLngsIHRlbXAueSwgdGVtcC5yb3RhdGlvbiwgdGVtcC5jb2xvcikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGZpbHRlclBsYXllcnMob2JqLGRhdGEpe1xyXG4gICAgICAgICAgICBpZihkYXRhLnVzZXJuYW1lID09IG9iai51c2VyTmFtZSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGRyYXcoKXtcclxuICAgICAgICAgICAgY3R4LmNsZWFyUmVjdCgwLDAsY2Fudi53aWR0aCwgY2Fudi5oZWlnaHQpO1xyXG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBjYW52LndpZHRoLzEwMDtcclxuXHJcbiAgICAgICAgICAgIGlmKEFsbEJ1bGxldHMubGVuZ3RoICE9IDApe1xyXG4gICAgICAgICAgICAgICAgdmFyIEJ1bGxldFdpZHRoID0gY2Fudi53aWR0aC8xMDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgQnVsbGV0SGVpZ2h0ID0gQnVsbGV0V2lkdGggKiBBbGxCdWxsZXRzWzBdLmltYWdlLmhlaWdodC9BbGxCdWxsZXRzWzBdLmltYWdlLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcih2YXIgYnVsbGV0IGluIEFsbEJ1bGxldHMpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gQWxsQnVsbGV0c1tidWxsZXRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShiLngqcmF0aW8sIGIueSpyYXRpbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LnJvdGF0ZShiLnJvdGF0aW9uLzE4MCpNYXRoLlBJKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGIuaW1hZ2UsIC1CdWxsZXRXaWR0aC8yLCAtQnVsbGV0SGVpZ2h0LzIsIEJ1bGxldFdpZHRoLCBCdWxsZXRIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgQWxsQnVsbGV0c1tidWxsZXRdLnggPSBNYXRoLmNvcygoYi5yb3RhdGlvbiAtIDkwKS8xODAqTWF0aC5QSSkgKyBiLng7XHJcbiAgICAgICAgICAgICAgICAgICAgQWxsQnVsbGV0c1tidWxsZXRdLnkgPSBNYXRoLnNpbigoYi5yb3RhdGlvbi05MCkvMTgwKk1hdGguUEkpKyBiLnk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKEFsbFBsYXllcnMubGVuZ3RoICE9IDApe1xyXG4gICAgICAgICAgICAgICAgdmFyIFNwYWNlc2hpcFdpZHRoID0gY2Fudi53aWR0aC8yMDtcclxuICAgICAgICAgICAgICAgIHZhciBTcGFjZXNoaXBIZWlnaHQgPSBTcGFjZXNoaXBXaWR0aCAqIEFsbFBsYXllcnNbMF0uaW1hZ2UuaGVpZ2h0LyBBbGxQbGF5ZXJzWzBdLmltYWdlLndpZHRoO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcih2YXIgcGxheWVyIGluIEFsbFBsYXllcnMpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gQWxsUGxheWVyc1twbGF5ZXJdO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShwLngqcmF0aW8sIHAueSpyYXRpbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LnJvdGF0ZShwLnJvdGF0aW9uLzE4MCpNYXRoLlBJKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHAuaW1hZ2UsIC1TcGFjZXNoaXBXaWR0aC8yLCAtU3BhY2VzaGlwSGVpZ2h0LzIsIFNwYWNlc2hpcFdpZHRoLCBTcGFjZXNoaXBIZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgQWxsUGxheWVyc1twbGF5ZXJdLnggPSBNYXRoLmNvcygocC5yb3RhdGlvbiAtIDkwKS8xODAqTWF0aC5QSSkvMTAqIHAuc3BlZWQgKyBwLng7XHJcbiAgICAgICAgICAgICAgICAgICAgQWxsUGxheWVyc1twbGF5ZXJdLnkgPSBNYXRoLnNpbigocC5yb3RhdGlvbi05MCkvMTgwKk1hdGguUEkpLzEwKiBwLnNwZWVkICsgcC55O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcFwiKS5jb250cm9sbGVyKFwicGxheUNvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiJGludGVydmFsXCIsIFwiJHdpbmRvd1wiLCBcInNvY2tldFNlcnZpY2VcIiwgXCJkaXNwbGF5U2VydmljZVwiLCBcInBsYXllclNlcnZpY2VcIiwgcGxheUNvbnRyb2xsZXJdKVxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGp1c3Rpam5kZXBvdmVyIG9uIDIyLzEyLzE1LlxyXG4gKi9cclxuXHJcbnZhciBCdWxsZXQgPSBmdW5jdGlvbih4LCB5LHJvdGF0aW9uLCBjb2xvcil7XHJcbiAgICB0aGlzLnggPSB4O1xyXG4gICAgdGhpcy55ID0geTtcclxuICAgIHRoaXMucm90YXRpb24gPSByb3RhdGlvbjtcclxuICAgIHRoaXMuaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcclxuICAgIGlmKHRoaXMuY29sb3IgPT0gXCJvcmFuZ2VcIil7XHJcbiAgICAgICAgdGhpcy5jb2xvciA9ICdyZWQnO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pbWFnZS5zcmMgPSAnLi4vYXNzZXRzL1BORy9MYXNlcnMvbGFzZXInKyB0aGlzLmNvbG9yLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGhpcy5jb2xvci5zbGljZSgxKSArJzAxLnBuZydcclxufTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAwOS8xMi8xNS5cclxuICovXHJcblxyXG52YXIgU3BhY2VzaGlwID0gZnVuY3Rpb24odXNlck5hbWUsIHgsIHksIGNvbG9yLCByb3RhdGlvbil7XHJcbiAgICB0aGlzLnVzZXJOYW1lID0gdXNlck5hbWU7XHJcbiAgICB0aGlzLnggPSB4O1xyXG4gICAgdGhpcy55ID0geTtcclxuICAgIHRoaXMuc3BlZWQgPSAxO1xyXG4gICAgdGhpcy5jb2xvciA9IGNvbG9yO1xyXG4gICAgdGhpcy5yb3RhdGlvbiA9IHJvdGF0aW9uO1xyXG4gICAgdGhpcy5pbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgdGhpcy5kYW1hZ2UgPSAwO1xyXG4gICAgdGhpcy5kYW1hZ2VJbWFnZSA9IG5ldyBJbWFnZSgpO1xyXG4gICAgdGhpcy5pbWFnZS5zcmMgPSAnLi4vYXNzZXRzL1BORy9wbGF5ZXJTaGlwMV8nKyB0aGlzLmNvbG9yICsnLnBuZydcclxufTtcclxuXHJcblNwYWNlc2hpcC5wcm90b3R5cGUubW92ZVNwYWNlc2hpcCA9IGZ1bmN0aW9uKHgsIHkpe1xyXG4gICAgdGhpcy54ID0geDtcclxuICAgIHRoaXMueSA9IHk7XHJcbn07XHJcblxyXG5TcGFjZXNoaXAucHJvdG90eXBlLm1vdmVTcGFjZXNoaXBSZWxhdGl2ZSA9IGZ1bmN0aW9uKHgsIHkpe1xyXG4gICAgdGhpcy54ID0gdGhpcy54K3g7XHJcbiAgICB0aGlzLnkgPSB0aGlzLnkreTtcclxufTtcclxuXHJcblNwYWNlc2hpcC5wcm90b3R5cGUucm90YXRlU3BhY2VzaGlwID0gZnVuY3Rpb24oZGVncmVlKXtcclxuICAgIHRoaXMucm90YXRpb24gPSBkZWdyZWU7XHJcbn07XHJcblxyXG5TcGFjZXNoaXAucHJvdG90eXBlLnJvdGF0ZVNwYWNlc2hpcFJlbGF0aXZlID0gZnVuY3Rpb24oZGVncmVlKXtcclxuICAgIHRoaXMucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uICsgZGVncmVlLzU7XHJcbiAgICBpZih0aGlzLnJvdGF0aW9uIDwgLTM2MCl7XHJcbiAgICAgICAgdGhpcy5yb3RhdGlvbiA9IHRoaXMucm90YXRpb24gKyA3MjA7XHJcbiAgICB9XHJcbiAgICBpZih0aGlzLnJvdGF0aW9uID4gMzYwKXtcclxuICAgICAgICB0aGlzLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbiAtIDcyMDtcclxuICAgIH1cclxufTtcclxuXHJcblNwYWNlc2hpcC5wcm90b3R5cGUuaW5jcmVhc2VEYW1hZ2UgPSBmdW5jdGlvbigpe1xyXG4gICAgaWYodGhpcy5kYW1hZ2UgPCA0KXtcclxuICAgICAgICB0aGlzLmRhbWFnZSArPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRoaXMuZGFtYWdlIDw9IDMgJiYgdGhpcy5kYW1hZ2UgPiAwKXtcclxuICAgICAgICB0aGlzLmRhbWFnZUltYWdlLnNyYyA9ICcuLi9hc3NldHMvUE5HL0RhbWFnZS9wbGF5ZXJTaGlwMV9kYW1hZ2UnKyB0aGlzLmRhbWFnZSArICcucG5nJztcclxuICAgIH1cclxufTtcclxuXHJcblNwYWNlc2hpcC5wcm90b3R5cGUuaW5jcmVhc2VEYW1hZ2UgPSBmdW5jdGlvbigpe1xyXG4gICAgaWYodGhpcy5kYW1hZ2UgPiAwKXtcclxuICAgICAgICB0aGlzLmRhbWFnZSAtPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRoaXMuZGFtYWdlIDw9IDMgJiYgdGhpcy5kYW1hZ2UgPiAwKXtcclxuICAgICAgICB0aGlzLmRhbWFnZUltYWdlLnNyYyA9ICcuLi9hc3NldHMvUE5HL0RhbWFnZS9wbGF5ZXJTaGlwMV9kYW1hZ2UnKyB0aGlzLmRhbWFnZSArICcucG5nJztcclxuICAgIH1cclxufTtcclxuXHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IE1pY2hpZWwgb24gMTYvMTIvMjAxNS5cclxuICovXHJcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGp1c3Rpam5kZXBvdmVyIG9uIDE2LzEyLzE1LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuICAgIHZhciBkaXNwbGF5U2VydmljZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy9Mb2dpbiBDb250cm9sbGVyXHJcbiAgICAgICAgdmFyIExDU2hvdyA9IHRydWU7XHJcbiAgICAgICAgLy9QbGF5IGNvbnRyb2xsZXJcclxuICAgICAgICB2YXIgUENTaG93ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHJldHVybntcclxuICAgICAgICAgICAgZ2V0TENTaG93OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIExDU2hvdztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0TENTaG93OiBmdW5jdGlvbih2YWx1ZSl7XHJcbiAgICAgICAgICAgICAgICBMQ1Nob3cgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ2V0UENTaG93OiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFBDU2hvdztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2V0UENTaG93OiBmdW5jdGlvbih2YWx1ZSl7XHJcbiAgICAgICAgICAgICAgICBQQ1Nob3cgPSB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2Rpc3BsYXlTZXJ2aWNlJywgW2Rpc3BsYXlTZXJ2aWNlXSk7XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkganVzdGlqbmRlcG92ZXIgb24gMTcvMTIvMTUuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgcGxheWVyU2VydmljZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLy9Mb2dpbiBDb250cm9sbGVyXHJcbiAgICAgICAgdmFyIHBsYXllcnMgPSBbXTtcclxuXHJcbiAgICAgICAgcmV0dXJue1xyXG4gICAgICAgICAgICBnZXRQbGF5ZXJzOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllcnM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldFBsYXllcnM6IGZ1bmN0aW9uKHBsYXllcnNBcnJheSl7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJzID0gcGxheWVyc0FycmF5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuZmFjdG9yeSgncGxheWVyU2VydmljZScsIFtwbGF5ZXJTZXJ2aWNlXSk7XHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkganVzdGlqbmRlcG92ZXIgb24gMDkvMTIvMTUuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgdmFyIHNvY2tldFNlcnZpY2UgPSBmdW5jdGlvbigkcm9vdFNjb3BlKXtcclxuICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAvL3ByaXZhdGVcclxuICAgICAgICB2YXIgc29ja2V0ID0gaW8uY29ubmVjdCh3aW5kb3cubG9jYXRpb24uaG9zdCk7XHJcbiAgICAgICAgLy9mdW5jdGlvbnNcclxuICAgICAgICB2YXIgb24gPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICBzb2NrZXQub24oZXZlbnROYW1lLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShzb2NrZXQsIGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBlbWl0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgc29ja2V0LmVtaXQoZXZlbnROYW1lLCBkYXRhLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkoc29ja2V0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL3B1YmxpY1xyXG4gICAgICAgIHJldHVybntcclxuICAgICAgICAgICAgb246IG9uLFxyXG4gICAgICAgICAgICBlbWl0OiBlbWl0LFxyXG4gICAgICAgICAgICBzb2NrZXQ6IHNvY2tldFxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHBcIikuZmFjdG9yeShcInNvY2tldFNlcnZpY2VcIiwgW1wiJHJvb3RTY29wZVwiLCBzb2NrZXRTZXJ2aWNlXSk7XHJcblxyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
