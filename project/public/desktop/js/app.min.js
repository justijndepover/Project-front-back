!function(){angular.module("app",[])}(),function(){var t=function(t,e,a,i){t.LCShow=a.getLCShow;var o=function(){e.emit("pcconnect",null)};t.room="",e.on("requestRoom",function(e){t.room=e}),e.on("deviceOrientation",function(t){var e=(t.username,{});e.gamma=t.gamma,e.beta=t.beta,e.alpha=t.alpha}),t.usernames={},t.checkUserCount=!1,e.on("updateusers",function(e){i.setPlayers(e),t.usernames=e,t.checkUserCount=Object.keys(t.usernames).length<0}),t.startGame=function(){e.emit("startGame",null),a.setLCShow(!1),a.setPCShow(!0)},function(){o()}()};angular.module("app").controller("loginController",["$scope","socketService","displayService","playerService",t])}(),function(){"use strict";var t=function(t,e,a,i,o,n){function r(t,e){return e.username==t.userName?!0:!1}function s(){u[0].speed=0,g.clearRect(0,0,p.width,p.height);var t=p.width/100;if(0!=d.length){var e=p.width/100,a=e*d[0].image.height/d[0].image.width;for(var i in d){var o=d[i];o.width=e,o.height=a,0==o.explodeStage?(g.save(),g.translate(o.x*t,o.y*t),g.rotate(o.rotation/180*Math.PI),g.drawImage(o.image,-e/2,-a/2,e,a),g.restore(),d[i].x=Math.cos((o.rotation-90)/180*Math.PI)+o.x,d[i].y=Math.sin((o.rotation-90)/180*Math.PI)+o.y):o.explodeStage<4&&(console.log(o.explosionImage),g.save(),g.translate(o.x*t,o.y*t),g.drawImage(o.explosionImage,-e,-e,2*e,2*e),g.restore())}}if(0!=u.length){var n=p.width/20,r=n*u[0].image.height/u[0].image.width;for(var s in u){var l=u[s];l.width=n,l.height=r,g.save(),g.translate(l.x*t,l.y*t),g.rotate(l.rotation/180*Math.PI),g.drawImage(l.image,-n/2,-r/2,n,r),l.damage>0&&g.drawImage(l.damageImage,-n/2,-r/2,n,r),g.restore(),u[s].x=Math.cos((l.rotation-90)/180*Math.PI)/10*l.speed+l.x,u[s].y=Math.sin((l.rotation-90)/180*Math.PI)/10*l.speed+l.y}}h(),c()}function h(){for(var t in d)(d[t].x<0||d[t].x>p.width||d[t].y<0||d[t].y>p.height)&&d.splice(t,1)}function c(){for(var t in u)for(var e in d)if(d[e].player!=u[t].userName){var a=Math.sqrt(2)/2*(d[e].height/2-d[e].width/2),i=(360-d[e].rotation)/180*Math.PI,o=d[e].x*p.width/100-a*Math.sin(i),n=d[e].y*p.width/100-a*Math.cos(i),r=u[t].x*p.width/100,s=u[t].y*p.width/100,h=Math.sqrt((o-r)*(o-r)+(n-s)*(n-s));if(h<d[e].width/2+u[t].width/2){var c=new Audio("../../assets/Bonus/sfx_lose.ogg");c.play(),u[t].increaseDamage(),d[e].explodeStage<4?d[e].explode():d.splice(e,1)}}}t.PCShow=o.getPCShow,t.startGame=!1;var l,p=document.getElementById("game"),g=p.getContext("2d"),u=new Array,d=new Array;i.on("initGame",function(){var t=n.getPlayers();for(var a in t){var i=t[a];u.push(new Spaceship(i.username,i.x,i.y,i.color,i.rotation))}l=e(s,10)}),i.on("updateGameData",function(t){var e=null;for(var a in u)1==r(u[a],t)&&(e=a);null!=e&&u[e].rotateSpaceshipRelative(t.orientation)}),i.on("playerShot",function(t){var e=null;for(var a in u)1==r(u[a],t)&&(e=a);if(null!=e){var i=u[e],o=(360-(i.rotation+180))/180*Math.PI,n=i.x+p.width/400*Math.sin(o),s=i.y+p.width/400*Math.cos(o);if(d.push(new Bullet(n,s,i.rotation,i.color,i.userName)),e%2==0)var h=new Audio("../../assets/Bonus/sfx_laser1.ogg");else var h=new Audio("../../assets/Bonus/sfx_laser2.ogg");h.play()}})};angular.module("app").controller("playController",["$scope","$interval","$window","socketService","displayService","playerService",t])}(),function(){var t=function(t){function e(e,a,i){t.innerWidth<t.innerHeight?e.width=t.innerWidth-20:e.width=t.innerHeight-20,angular.element(t).bind("resize",function(){t.innerWidth<t.innerHeight?e.width=t.innerWidth-20:e.width=t.innerHeight-20,e.$digest()})}return{restrict:"E",link:e,replace:!0,template:'<canvas id="game" class="playArea" width="{{width}}" height="{{width}}" />'}};angular.module("app").directive("canvasDirective",["$window",t])}();var Bullet=function(t,e,a,i,o){this.x=t,this.y=e,this.rotation=a,this.image=new Image,this.color=i,this.width=0,this.height=0,this.player=o,this.explosionImage=new Image,this.explodeStage=0,"orange"==this.color&&(this.color="red"),this.image.src="../assets/PNG/Lasers/laser"+this.color.charAt(0).toUpperCase()+this.color.slice(1)+"01.png"};Bullet.prototype.explode=function(){if(this.explodeStage<4){this.explodeStage++;var t;t=this.explodeStage<3?1:2,this.explosionImage.src="../assets/PNG/Lasers/laser"+this.color.charAt(0).toUpperCase()+this.color.slice(1)+"Explode"+t+".png"}else this.explosionImage.src=""};var Spaceship=function(t,e,a,i,o){this.userName=t,this.x=e,this.y=a,this.speed=1,this.color=i,this.rotation=o,this.image=new Image,this.damage=0,this.width=0,this.height=0,this.damageImage=new Image,this.image.src="../assets/PNG/playerShip1_"+this.color+".png"};Spaceship.prototype.moveSpaceship=function(t,e){this.x=t,this.y=e},Spaceship.prototype.moveSpaceshipRelative=function(t,e){this.x=this.x+t,this.y=this.y+e},Spaceship.prototype.rotateSpaceship=function(t){this.rotation=t},Spaceship.prototype.rotateSpaceshipRelative=function(t){this.rotation=this.rotation+t/5,this.rotation<-360&&(this.rotation=this.rotation+720),this.rotation>360&&(this.rotation=this.rotation-720)},Spaceship.prototype.increaseDamage=function(){this.damage<4&&(this.damage+=1),this.damage<=3&&this.damage>0&&(this.damageImage.src="../assets/PNG/Damage/playerShip1_damage"+this.damage+".png")},Spaceship.prototype.decreaseDamage=function(){this.damage>0&&(this.damage-=1),this.damage<=3&&this.damage>0&&(this.damageImage.src="../assets/PNG/Damage/playerShip1_damage"+this.damage+".png")},function(){var t=function(){var t=!0,e=!1;return{getLCShow:function(){return t},setLCShow:function(e){t=e},getPCShow:function(){return e},setPCShow:function(t){e=t}}};angular.module("app").factory("displayService",[t])}(),function(){var t=function(){var t=[];return{getPlayers:function(){return t},setPlayers:function(e){t=e}}};angular.module("app").factory("playerService",[t])}(),function(){var t=function(t){"use strict";var e=io.connect(window.location.host),a=function(a,i){e.on(a,function(){var a=arguments;t.$apply(function(){i.apply(e,a)})})},i=function(a,i,o){e.emit(a,i,function(){var a=arguments;t.$apply(function(){o&&o.apply(e,a)})})};return{on:a,emit:i,socket:e}};angular.module("app").factory("socketService",["$rootScope",t])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXIvbG9naW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlci9wbGF5Q29udHJvbGxlci5qcyIsImRpcmVjdGl2ZXMvY2FudmFzRGlyZWN0aXZlLmpzIiwibW9kZWxzL0J1bGxldC5qcyIsIm1vZGVscy9TcGFjZXNoaXAuanMiLCJzZXJ2aWNlcy9kaXNwbGF5U2VydmljZS5qcyIsInNlcnZpY2VzL3BsYXllclNlcnZpY2UuanMiLCJzZXJ2aWNlcy9zb2NrZXRTZXJ2aWNlLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJsb2dpbkNvbnRyb2xsZXIiLCIkc2NvcGUiLCJzb2NrZXRTZXJ2aWNlIiwiZGlzcGxheVNlcnZpY2UiLCJwbGF5ZXJTZXJ2aWNlIiwiTENTaG93IiwiZ2V0TENTaG93IiwibWFrZVJvb20iLCJlbWl0Iiwicm9vbSIsIm9uIiwiZGF0YSIsImRldmljZU9yaWVudGF0aW9uIiwidXNlcm5hbWUiLCJnYW1tYSIsImJldGEiLCJhbHBoYSIsInVzZXJuYW1lcyIsImNoZWNrVXNlckNvdW50Iiwic2V0UGxheWVycyIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJzdGFydEdhbWUiLCJzZXRMQ1Nob3ciLCJzZXRQQ1Nob3ciLCJjb250cm9sbGVyIiwicGxheUNvbnRyb2xsZXIiLCIkaW50ZXJ2YWwiLCIkd2luZG93IiwiZmlsdGVyUGxheWVycyIsIm9iaiIsInVzZXJOYW1lIiwiZHJhdyIsIkFsbFBsYXllcnMiLCJzcGVlZCIsImN0eCIsImNsZWFyUmVjdCIsImNhbnYiLCJ3aWR0aCIsImhlaWdodCIsInJhdGlvIiwiQWxsQnVsbGV0cyIsIkJ1bGxldFdpZHRoIiwiQnVsbGV0SGVpZ2h0IiwiaW1hZ2UiLCJidWxsZXQiLCJiIiwiZXhwbG9kZVN0YWdlIiwic2F2ZSIsInRyYW5zbGF0ZSIsIngiLCJ5Iiwicm90YXRlIiwicm90YXRpb24iLCJNYXRoIiwiUEkiLCJkcmF3SW1hZ2UiLCJyZXN0b3JlIiwiY29zIiwic2luIiwiY29uc29sZSIsImxvZyIsImV4cGxvc2lvbkltYWdlIiwiU3BhY2VzaGlwV2lkdGgiLCJTcGFjZXNoaXBIZWlnaHQiLCJwbGF5ZXIiLCJwIiwiZGFtYWdlIiwiZGFtYWdlSW1hZ2UiLCJjaGVja0J1bGxldHMiLCJjb2xsaXNpb25EZXRlY3Rpb24iLCJzcGxpY2UiLCJyYWRpdXMiLCJzcXJ0IiwiYW5nbGUiLCJidWxsZXRIZWFkWCIsImJ1bGxldEhlYWRZIiwic3BhY2VTaGlwWCIsInNwYWNlU2hpcFkiLCJkaXN0YW5jZSIsImRhbWFnZXNvdW5kIiwiQXVkaW8iLCJwbGF5IiwiaW5jcmVhc2VEYW1hZ2UiLCJleHBsb2RlIiwiUENTaG93IiwiZ2V0UENTaG93IiwiY3ljbGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsIkFycmF5IiwiQnVmZmVyUGxheWVyIiwiZ2V0UGxheWVycyIsInB1c2giLCJTcGFjZXNoaXAiLCJjb2xvciIsImkiLCJyb3RhdGVTcGFjZXNoaXBSZWxhdGl2ZSIsIm9yaWVudGF0aW9uIiwidGVtcCIsIkJ1bGxldCIsInNob3QiLCJjYW52YXNEaXJlY3RpdmUiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJiaW5kIiwiJGRpZ2VzdCIsInJlc3RyaWN0IiwicmVwbGFjZSIsInRlbXBsYXRlIiwiZGlyZWN0aXZlIiwidGhpcyIsIkltYWdlIiwic3JjIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsInByb3RvdHlwZSIsIm51bWJlciIsIm1vdmVTcGFjZXNoaXAiLCJtb3ZlU3BhY2VzaGlwUmVsYXRpdmUiLCJyb3RhdGVTcGFjZXNoaXAiLCJkZWdyZWUiLCJkZWNyZWFzZURhbWFnZSIsInZhbHVlIiwiZmFjdG9yeSIsInBsYXllcnMiLCJwbGF5ZXJzQXJyYXkiLCIkcm9vdFNjb3BlIiwic29ja2V0IiwiaW8iLCJjb25uZWN0Iiwid2luZG93IiwibG9jYXRpb24iLCJo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UUFBQSxHQUFBaUQsS0FBQWpELE9BQUEsSUFDQWlELEtBQUFoRCxZQUFBa0QsSUFBQSwwQ0FBQUYsS0FBQWpELE9BQUEsU0NuREEsV0FDQSxHQUFBakUsR0FBQSxXQUVBLEdBQUFFLElBQUEsRUFFQWlGLEdBQUEsQ0FFQSxRQUNBaEYsVUFBQSxXQUNBLE1BQUFELElBRUFtQixVQUFBLFNBQUEwRyxHQUNBN0gsRUFBQTZILEdBRUEzQyxVQUFBLFdBQ0EsTUFBQUQsSUFFQTdELFVBQUEsU0FBQXlHLEdBQ0E1QyxFQUFBNEMsSUFLQXBJLFNBQUFDLE9BQUEsT0FBQW9JLFFBQUEsa0JBQUFoSSxPQzNCQSxXQUNBLEdBQUFDLEdBQUEsV0FFQSxHQUFBZ0ksS0FFQSxRQUNBdEMsV0FBQSxXQUNBLE1BQUFzQyxJQUVBakgsV0FBQSxTQUFBa0gsR0FDQUQsRUFBQUMsSUFLQXZJLFNBQUFDLE9BQUEsT0FBQW9JLFFBQUEsaUJBQUEvSCxPQ2ZBLFdBRUEsR0FBQUYsR0FBQSxTQUFBb0ksR0FDQSxZQUVBLElBQUFDLEdBQUFDLEdBQUFDLFFBQUFDLE9BQUFDLFNBQUFDLE1BRUFsSSxFQUFBLFNBQUFtSSxFQUFBQyxHQUNBUCxFQUFBN0gsR0FBQW1JLEVBQUEsV0FDQSxHQUFBRSxHQUFBQyxTQUNBVixHQUFBVyxPQUFBLFdBQ0FILEVBQUFJLE1BQUFYLEVBQUFRLFFBS0F2SSxFQUFBLFNBQUFxSSxFQUFBbEksRUFBQW1JLEdBQ0FQLEVBQUEvSCxLQUFBcUksRUFBQWxJLEVBQUEsV0FDQSxHQUFBb0ksR0FBQUMsU0FDQVYsR0FBQVcsT0FBQSxXQUNBSCxHQUNBQSxFQUFBSSxNQUFBWCxFQUFBUSxPQU9BLFFBQ0FySSxHQUFBQSxFQUNBRixLQUFBQSxFQUNBK0gsT0FBQUEsR0FJQXpJLFNBQUFDLE9BQUEsT0FBQW9JLFFBQUEsaUJBQUEsYUFBQWpJIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENyZWF0ZWQgYnkgTWljaGllbCBvbiAyNS8xMS8yMDE1LlxuICovXG4oZnVuY3Rpb24oKXtcblxuICAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZShcImFwcFwiLFtdKTtcbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IE1pY2hpZWwgb24gMTEvMTIvMjAxNS5cbiAqL1xuXG4oZnVuY3Rpb24oKXtcbiAgICB2YXIgbG9naW5Db250cm9sbGVyID0gZnVuY3Rpb24oJHNjb3BlLCBzb2NrZXRTZXJ2aWNlLCBkaXNwbGF5U2VydmljZSwgcGxheWVyU2VydmljZSl7XG5cbiAgICAgICAgJHNjb3BlLkxDU2hvdyA9IGRpc3BsYXlTZXJ2aWNlLmdldExDU2hvdztcblxuICAgICAgICAvL2Z1bmN0aW9uc1xuICAgICAgICB2YXIgbWFrZVJvb20gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgc29ja2V0U2VydmljZS5lbWl0KFwicGNjb25uZWN0XCIsIG51bGwpO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUucm9vbSA9IFwiXCI7XG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oJ3JlcXVlc3RSb29tJyxmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgICRzY29wZS5yb29tID0gZGF0YTtcbiAgICAgICAgfSk7XG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oJ2RldmljZU9yaWVudGF0aW9uJywgZnVuY3Rpb24oZGF0YSl7XG4gICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSBkYXRhLnVzZXJuYW1lO1xuICAgICAgICAgICAgdmFyIGRldmljZU9yaWVudGF0aW9uID0ge307XG4gICAgICAgICAgICBkZXZpY2VPcmllbnRhdGlvbi5nYW1tYSA9IGRhdGEuZ2FtbWE7XG4gICAgICAgICAgICBkZXZpY2VPcmllbnRhdGlvbi5iZXRhID0gZGF0YS5iZXRhO1xuICAgICAgICAgICAgZGV2aWNlT3JpZW50YXRpb24uYWxwaGEgPSBkYXRhLmFscGhhO1xuICAgICAgICB9KTtcbiAgICAgICAgJHNjb3BlLnVzZXJuYW1lcyA9IHt9O1xuICAgICAgICAkc2NvcGUuY2hlY2tVc2VyQ291bnQgPSBmYWxzZTtcbiAgICAgICAgc29ja2V0U2VydmljZS5vbigndXBkYXRldXNlcnMnLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgcGxheWVyU2VydmljZS5zZXRQbGF5ZXJzKGRhdGEpO1xuICAgICAgICAgICAgJHNjb3BlLnVzZXJuYW1lcyA9IGRhdGE7XG4gICAgICAgICAgICAkc2NvcGUuY2hlY2tVc2VyQ291bnQgPSBPYmplY3Qua2V5cygkc2NvcGUudXNlcm5hbWVzKS5sZW5ndGggPCAwO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuc3RhcnRHYW1lPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzb2NrZXRTZXJ2aWNlLmVtaXQoXCJzdGFydEdhbWVcIiwgbnVsbCk7XG4gICAgICAgICAgICBkaXNwbGF5U2VydmljZS5zZXRMQ1Nob3coZmFsc2UpO1xuICAgICAgICAgICAgZGlzcGxheVNlcnZpY2Uuc2V0UENTaG93KHRydWUpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbWFrZVJvb20oKTtcbiAgICAgICAgfSkoKTtcblxuICAgIH07XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcFwiKS5jb250cm9sbGVyKFwibG9naW5Db250cm9sbGVyXCIsIFtcIiRzY29wZVwiLCBcInNvY2tldFNlcnZpY2VcIiAsIFwiZGlzcGxheVNlcnZpY2VcIiwgXCJwbGF5ZXJTZXJ2aWNlXCIsIGxvZ2luQ29udHJvbGxlcl0pO1xufSkoKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgTWljaGllbCBvbiAxNi8xMi8yMDE1LlxuICovXG5cbihmdW5jdGlvbigpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBwbGF5Q29udHJvbGxlciA9IGZ1bmN0aW9uKCRzY29wZSwgJGludGVydmFsLCAkd2luZG93LCBzb2NrZXRTZXJ2aWNlLCBkaXNwbGF5U2VydmljZSwgcGxheWVyU2VydmljZSl7XG4gICAgICAgICRzY29wZS5QQ1Nob3cgPSBkaXNwbGF5U2VydmljZS5nZXRQQ1Nob3c7XG4gICAgICAgICRzY29wZS5zdGFydEdhbWUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGNhbnYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZScpO1xuICAgICAgICB2YXIgY3R4ID0gY2Fudi5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgIHZhciBBbGxQbGF5ZXJzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHZhciBBbGxCdWxsZXRzID0gbmV3IEFycmF5KCk7XG5cbiAgICAgICAgdmFyIGN5Y2xlO1xuXG4gICAgICAgIHNvY2tldFNlcnZpY2Uub24oXCJpbml0R2FtZVwiLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIEJ1ZmZlclBsYXllciA9IHBsYXllclNlcnZpY2UuZ2V0UGxheWVycygpO1xuICAgICAgICAgICAgZm9yKHZhciBwbGF5ZXIgaW4gQnVmZmVyUGxheWVyKXtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IEJ1ZmZlclBsYXllcltwbGF5ZXJdO1xuICAgICAgICAgICAgICAgIEFsbFBsYXllcnMucHVzaChuZXcgU3BhY2VzaGlwKHAudXNlcm5hbWUsIHAueCwgcC55LCBwLmNvbG9yLCBwLnJvdGF0aW9uKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGN5Y2xlID0gJGludGVydmFsKGRyYXcsIDEwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc29ja2V0U2VydmljZS5vbihcInVwZGF0ZUdhbWVEYXRhXCIsIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgdmFyIHAgPSBudWxsO1xuICAgICAgICAgICAgZm9yKHZhciBpIGluIEFsbFBsYXllcnMpe1xuICAgICAgICAgICAgICAgIGlmKGZpbHRlclBsYXllcnMoQWxsUGxheWVyc1tpXSxkYXRhKSA9PSB0cnVlKXtcbiAgICAgICAgICAgICAgICAgICAgcCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYocCAhPSBudWxsKXtcbiAgICAgICAgICAgICAgICBBbGxQbGF5ZXJzW3BdLnJvdGF0ZVNwYWNlc2hpcFJlbGF0aXZlKGRhdGEub3JpZW50YXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzb2NrZXRTZXJ2aWNlLm9uKFwicGxheWVyU2hvdFwiLCBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgICAgIHZhciBwID0gbnVsbDtcbiAgICAgICAgICAgIGZvcih2YXIgaSBpbiBBbGxQbGF5ZXJzKXtcbiAgICAgICAgICAgICAgICBpZihmaWx0ZXJQbGF5ZXJzKEFsbFBsYXllcnNbaV0sZGF0YSkgPT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgICAgIHAgPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKHAgIT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBBbGxQbGF5ZXJzW3BdO1xuICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9ICgzNjAgLSh0ZW1wLnJvdGF0aW9uICsgMTgwKSkvMTgwKk1hdGguUEk7XG4gICAgICAgICAgICAgICAgdmFyIHggPSB0ZW1wLnggKyAoY2Fudi53aWR0aC80MDAgKiBNYXRoLnNpbihhbmdsZSkpO1xuICAgICAgICAgICAgICAgIHZhciB5ID0gdGVtcC55ICsgKGNhbnYud2lkdGgvNDAwICogTWF0aC5jb3MoYW5nbGUpKTtcbiAgICAgICAgICAgICAgICBBbGxCdWxsZXRzLnB1c2gobmV3IEJ1bGxldCh4LCB5LCB0ZW1wLnJvdGF0aW9uLCB0ZW1wLmNvbG9yLCB0ZW1wLnVzZXJOYW1lKSk7XG4gICAgICAgICAgICAgICAgaWYocCUyID09IDApe1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2hvdCA9IG5ldyBBdWRpbygnLi4vLi4vYXNzZXRzL0JvbnVzL3NmeF9sYXNlcjEub2dnJyk7XG4gICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaG90ID0gbmV3IEF1ZGlvKCcuLi8uLi9hc3NldHMvQm9udXMvc2Z4X2xhc2VyMi5vZ2cnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2hvdC5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGZpbHRlclBsYXllcnMob2JqLGRhdGEpe1xuICAgICAgICAgICAgaWYoZGF0YS51c2VybmFtZSA9PSBvYmoudXNlck5hbWUpe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZHJhdygpe1xuICAgICAgICAgICAgQWxsUGxheWVyc1swXS5zcGVlZCA9IDA7XG4gICAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsMCxjYW52LndpZHRoLCBjYW52LmhlaWdodCk7XG4gICAgICAgICAgICB2YXIgcmF0aW8gPSBjYW52LndpZHRoLzEwMDtcblxuICAgICAgICAgICAgaWYoQWxsQnVsbGV0cy5sZW5ndGggIT0gMCl7XG4gICAgICAgICAgICAgICAgdmFyIEJ1bGxldFdpZHRoID0gY2Fudi53aWR0aC8xMDA7XG4gICAgICAgICAgICAgICAgdmFyIEJ1bGxldEhlaWdodCA9IEJ1bGxldFdpZHRoICogQWxsQnVsbGV0c1swXS5pbWFnZS5oZWlnaHQvQWxsQnVsbGV0c1swXS5pbWFnZS53aWR0aDtcblxuICAgICAgICAgICAgICAgIGZvcih2YXIgYnVsbGV0IGluIEFsbEJ1bGxldHMpe1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IEFsbEJ1bGxldHNbYnVsbGV0XTtcbiAgICAgICAgICAgICAgICAgICAgYi53aWR0aCA9IEJ1bGxldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICBiLmhlaWdodCA9IEJ1bGxldEhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgICBpZihiLmV4cGxvZGVTdGFnZSA9PSAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vRHJhdyBidWxsZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgudHJhbnNsYXRlKGIueCpyYXRpbywgYi55KnJhdGlvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yb3RhdGUoYi5yb3RhdGlvbi8xODAqTWF0aC5QSSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGIuaW1hZ2UsIC1CdWxsZXRXaWR0aC8yLCAtQnVsbGV0SGVpZ2h0LzIsIEJ1bGxldFdpZHRoLCBCdWxsZXRIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnJlc3RvcmUoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgQWxsQnVsbGV0c1tidWxsZXRdLnggPSBNYXRoLmNvcygoYi5yb3RhdGlvbiAtIDkwKS8xODAqTWF0aC5QSSkgKyBiLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBBbGxCdWxsZXRzW2J1bGxldF0ueSA9IE1hdGguc2luKChiLnJvdGF0aW9uIC0gOTApLzE4MCpNYXRoLlBJKSsgYi55O1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZSBpZihiLmV4cGxvZGVTdGFnZSA8IDQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9EcmF3IGV4cGxvc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYi5leHBsb3Npb25JbWFnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShiLngqcmF0aW8sIGIueSpyYXRpbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGIuZXhwbG9zaW9uSW1hZ2UsIC1CdWxsZXRXaWR0aCwgLUJ1bGxldFdpZHRoLCBCdWxsZXRXaWR0aCoyLCBCdWxsZXRXaWR0aCoyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKEFsbFBsYXllcnMubGVuZ3RoICE9IDApe1xuICAgICAgICAgICAgICAgIHZhciBTcGFjZXNoaXBXaWR0aCA9IGNhbnYud2lkdGgvMjA7XG4gICAgICAgICAgICAgICAgdmFyIFNwYWNlc2hpcEhlaWdodCA9IFNwYWNlc2hpcFdpZHRoICogQWxsUGxheWVyc1swXS5pbWFnZS5oZWlnaHQvIEFsbFBsYXllcnNbMF0uaW1hZ2Uud2lkdGg7XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIHBsYXllciBpbiBBbGxQbGF5ZXJzKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBBbGxQbGF5ZXJzW3BsYXllcl07XG4gICAgICAgICAgICAgICAgICAgIHAud2lkdGggPSBTcGFjZXNoaXBXaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgcC5oZWlnaHQgPSBTcGFjZXNoaXBIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgICAgIGN0eC50cmFuc2xhdGUocC54KnJhdGlvLCBwLnkqcmF0aW8pO1xuICAgICAgICAgICAgICAgICAgICBjdHgucm90YXRlKHAucm90YXRpb24vMTgwKk1hdGguUEkpO1xuICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKHAuaW1hZ2UsIC1TcGFjZXNoaXBXaWR0aC8yLCAtU3BhY2VzaGlwSGVpZ2h0LzIsIFNwYWNlc2hpcFdpZHRoLCBTcGFjZXNoaXBIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICBpZihwLmRhbWFnZSA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShwLmRhbWFnZUltYWdlLCAtU3BhY2VzaGlwV2lkdGgvMiwgLVNwYWNlc2hpcEhlaWdodC8yLCBTcGFjZXNoaXBXaWR0aCwgU3BhY2VzaGlwSGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpO1xuICAgICAgICAgICAgICAgICAgICBBbGxQbGF5ZXJzW3BsYXllcl0ueCA9IE1hdGguY29zKChwLnJvdGF0aW9uIC0gOTApLzE4MCpNYXRoLlBJKS8xMCogcC5zcGVlZCArIHAueDtcbiAgICAgICAgICAgICAgICAgICAgQWxsUGxheWVyc1twbGF5ZXJdLnkgPSBNYXRoLnNpbigocC5yb3RhdGlvbiAtIDkwKS8xODAqTWF0aC5QSSkvMTAqIHAuc3BlZWQgKyBwLnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGVja0J1bGxldHMoKTtcblxuICAgICAgICAgICAgY29sbGlzaW9uRGV0ZWN0aW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjaGVja0J1bGxldHMoKXtcblxuICAgICAgICAgICAgZm9yKHZhciBiIGluIEFsbEJ1bGxldHMpe1xuICAgICAgICAgICAgICAgIGlmKEFsbEJ1bGxldHNbYl0ueCA8IDAgfHwgQWxsQnVsbGV0c1tiXS54ID4gY2Fudi53aWR0aCB8fCBBbGxCdWxsZXRzW2JdLnkgPCAwIHx8IEFsbEJ1bGxldHNbYl0ueSA+IGNhbnYuaGVpZ2h0KXtcbiAgICAgICAgICAgICAgICAgICAgQWxsQnVsbGV0cy5zcGxpY2UoYiwgMSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb2xsaXNpb25EZXRlY3Rpb24oKXtcbiAgICAgICAgICAgIGZvcih2YXIgcCBpbiBBbGxQbGF5ZXJzKXtcbiAgICAgICAgICAgICAgICBmb3IodmFyIGIgaW4gQWxsQnVsbGV0cyl7XG4gICAgICAgICAgICAgICAgICAgIGlmKEFsbEJ1bGxldHNbYl0ucGxheWVyICE9IEFsbFBsYXllcnNbcF0udXNlck5hbWUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhZGl1cyA9IE1hdGguc3FydCgyKS8yKihBbGxCdWxsZXRzW2JdLmhlaWdodC8yIC0gQWxsQnVsbGV0c1tiXS53aWR0aC8yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbmdsZSA9ICgzNjAgLShBbGxCdWxsZXRzW2JdLnJvdGF0aW9uKSkvMTgwKk1hdGguUEk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVsbGV0SGVhZFggPSAoQWxsQnVsbGV0c1tiXS54KmNhbnYud2lkdGgvMTAwIC0gKHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1bGxldEhlYWRZID0gKEFsbEJ1bGxldHNbYl0ueSpjYW52LndpZHRoLzEwMCAtIChyYWRpdXMgKiBNYXRoLmNvcyhhbmdsZSkpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwYWNlU2hpcFggPSBBbGxQbGF5ZXJzW3BdLngqY2Fudi53aWR0aC8xMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BhY2VTaGlwWSA9IEFsbFBsYXllcnNbcF0ueSpjYW52LndpZHRoLzEwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLypjdHguc2F2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFyYyhzcGFjZVNoaXBYLCBzcGFjZVNoaXBZLCBBbGxQbGF5ZXJzW3BdLndpZHRoLzIsIDAsIE1hdGguUEkqMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICcjMDAwMEZGJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5zYXZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguYXJjKGJ1bGxldEhlYWRYLCBidWxsZXRIZWFkWSwgQWxsQnVsbGV0c1tiXS53aWR0aC8yLCAwLCBNYXRoLlBJKjIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSAnI0ZGMDAwMCc7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgucmVzdG9yZSgpOyovXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoKGJ1bGxldEhlYWRYLXNwYWNlU2hpcFgpKihidWxsZXRIZWFkWC1zcGFjZVNoaXBYKSArIChidWxsZXRIZWFkWS1zcGFjZVNoaXBZKSooYnVsbGV0SGVhZFktc3BhY2VTaGlwWSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGlzdGFuY2UgPCAoQWxsQnVsbGV0c1tiXS53aWR0aC8yICsgQWxsUGxheWVyc1twXS53aWR0aC8yKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhbWFnZXNvdW5kID0gbmV3IEF1ZGlvKCcuLi8uLi9hc3NldHMvQm9udXMvc2Z4X2xvc2Uub2dnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlc291bmQucGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFsbFBsYXllcnNbcF0uaW5jcmVhc2VEYW1hZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihBbGxCdWxsZXRzW2JdLmV4cGxvZGVTdGFnZSA8IDQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBbGxCdWxsZXRzW2JdLmV4cGxvZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWxsQnVsbGV0cy5zcGxpY2UoYiwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwXCIpLmNvbnRyb2xsZXIoXCJwbGF5Q29udHJvbGxlclwiLCBbXCIkc2NvcGVcIiwgXCIkaW50ZXJ2YWxcIiwgXCIkd2luZG93XCIsIFwic29ja2V0U2VydmljZVwiLCBcImRpc3BsYXlTZXJ2aWNlXCIsIFwicGxheWVyU2VydmljZVwiLCBwbGF5Q29udHJvbGxlcl0pXG59KSgpOyIsIi8qKlxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAxNi8xMi8xNS5cbiAqL1xuKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGNhbnZhc0RpcmVjdGl2ZSA9IGZ1bmN0aW9uKCR3aW5kb3cpe1xuICAgICAgICByZXR1cm57XG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxuICAgICAgICAgICAgbGluazpsaW5rLFxuICAgICAgICAgICAgcmVwbGFjZTp0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGU6JzxjYW52YXMgaWQ9XCJnYW1lXCIgY2xhc3M9XCJwbGF5QXJlYVwiIHdpZHRoPVwie3t3aWR0aH19XCIgaGVpZ2h0PVwie3t3aWR0aH19XCIgLz4nXG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpe1xuICAgICAgICAgICAgaWYoJHdpbmRvdy5pbm5lcldpZHRoIDwgJHdpbmRvdy5pbm5lckhlaWdodCl7XG4gICAgICAgICAgICAgICAgc2NvcGUud2lkdGggPSAkd2luZG93LmlubmVyV2lkdGggLSAyMDtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHNjb3BlLndpZHRoID0gJHdpbmRvdy5pbm5lckhlaWdodCAtIDIwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdykuYmluZCgncmVzaXplJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZigkd2luZG93LmlubmVyV2lkdGggPCAkd2luZG93LmlubmVySGVpZ2h0KXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUud2lkdGggPSAkd2luZG93LmlubmVyV2lkdGggLSAyMDtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUud2lkdGggPSAkd2luZG93LmlubmVySGVpZ2h0IC0gMjA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2NvcGUuJGRpZ2VzdCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmRpcmVjdGl2ZShcImNhbnZhc0RpcmVjdGl2ZVwiLCBbXCIkd2luZG93XCIsIGNhbnZhc0RpcmVjdGl2ZV0pO1xufSkoKTsiLCIvKipcbiAqIENyZWF0ZWQgYnkganVzdGlqbmRlcG92ZXIgb24gMjIvMTIvMTUuXG4gKi9cblxudmFyIEJ1bGxldCA9IGZ1bmN0aW9uKHgsIHkscm90YXRpb24sIGNvbG9yLCBwbGF5ZXIpe1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbiAgICB0aGlzLnJvdGF0aW9uID0gcm90YXRpb247XG4gICAgdGhpcy5pbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcbiAgICB0aGlzLndpZHRoID0gMDtcbiAgICB0aGlzLmhlaWdodCA9IDA7XG4gICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXI7XG4gICAgdGhpcy5leHBsb3Npb25JbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgIHRoaXMuZXhwbG9kZVN0YWdlID0gMDtcbiAgICBpZih0aGlzLmNvbG9yID09IFwib3JhbmdlXCIpe1xuICAgICAgICB0aGlzLmNvbG9yID0gJ3JlZCc7XG4gICAgfVxuICAgIHRoaXMuaW1hZ2Uuc3JjID0gJy4uL2Fzc2V0cy9QTkcvTGFzZXJzL2xhc2VyJysgdGhpcy5jb2xvci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMuY29sb3Iuc2xpY2UoMSkgKycwMS5wbmcnXG59O1xuXG5CdWxsZXQucHJvdG90eXBlLmV4cGxvZGUgPSBmdW5jdGlvbigpe1xuICAgIGlmKHRoaXMuZXhwbG9kZVN0YWdlIDwgNCl7XG4gICAgICAgIHRoaXMuZXhwbG9kZVN0YWdlKys7XG4gICAgICAgIHZhciBudW1iZXI7XG4gICAgICAgIGlmKHRoaXMuZXhwbG9kZVN0YWdlIDwgMyl7XG4gICAgICAgICAgIG51bWJlciA9IDFcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBudW1iZXIgPSAyXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5leHBsb3Npb25JbWFnZS5zcmMgPSAnLi4vYXNzZXRzL1BORy9MYXNlcnMvbGFzZXInICsgdGhpcy5jb2xvci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMuY29sb3Iuc2xpY2UoMSkgKyAnRXhwbG9kZScrIG51bWJlciArJy5wbmcnO1xuICAgIH1lbHNle1xuICAgICAgICB0aGlzLmV4cGxvc2lvbkltYWdlLnNyYyA9ICcnO1xuICAgIH1cbn07XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkganVzdGlqbmRlcG92ZXIgb24gMDkvMTIvMTUuXG4gKi9cblxudmFyIFNwYWNlc2hpcCA9IGZ1bmN0aW9uKHVzZXJOYW1lLCB4LCB5LCBjb2xvciwgcm90YXRpb24pe1xuICAgIHRoaXMudXNlck5hbWUgPSB1c2VyTmFtZTtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gICAgdGhpcy5zcGVlZCA9IDE7XG4gICAgdGhpcy5jb2xvciA9IGNvbG9yO1xuICAgIHRoaXMucm90YXRpb24gPSByb3RhdGlvbjtcbiAgICB0aGlzLmltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgdGhpcy5kYW1hZ2UgPSAwO1xuICAgIHRoaXMud2lkdGggPSAwO1xuICAgIHRoaXMuaGVpZ2h0ID0gMDtcbiAgICB0aGlzLmRhbWFnZUltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgdGhpcy5pbWFnZS5zcmMgPSAnLi4vYXNzZXRzL1BORy9wbGF5ZXJTaGlwMV8nKyB0aGlzLmNvbG9yICsnLnBuZydcbn07XG5cblNwYWNlc2hpcC5wcm90b3R5cGUubW92ZVNwYWNlc2hpcCA9IGZ1bmN0aW9uKHgsIHkpe1xuICAgIHRoaXMueCA9IHg7XG4gICAgdGhpcy55ID0geTtcbn07XG5cblNwYWNlc2hpcC5wcm90b3R5cGUubW92ZVNwYWNlc2hpcFJlbGF0aXZlID0gZnVuY3Rpb24oeCwgeSl7XG4gICAgdGhpcy54ID0gdGhpcy54K3g7XG4gICAgdGhpcy55ID0gdGhpcy55K3k7XG59O1xuXG5TcGFjZXNoaXAucHJvdG90eXBlLnJvdGF0ZVNwYWNlc2hpcCA9IGZ1bmN0aW9uKGRlZ3JlZSl7XG4gICAgdGhpcy5yb3RhdGlvbiA9IGRlZ3JlZTtcbn07XG5cblNwYWNlc2hpcC5wcm90b3R5cGUucm90YXRlU3BhY2VzaGlwUmVsYXRpdmUgPSBmdW5jdGlvbihkZWdyZWUpe1xuICAgIHRoaXMucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uICsgZGVncmVlLzU7XG4gICAgaWYodGhpcy5yb3RhdGlvbiA8IC0zNjApe1xuICAgICAgICB0aGlzLnJvdGF0aW9uID0gdGhpcy5yb3RhdGlvbiArIDcyMDtcbiAgICB9XG4gICAgaWYodGhpcy5yb3RhdGlvbiA+IDM2MCl7XG4gICAgICAgIHRoaXMucm90YXRpb24gPSB0aGlzLnJvdGF0aW9uIC0gNzIwO1xuICAgIH1cbn07XG5cblNwYWNlc2hpcC5wcm90b3R5cGUuaW5jcmVhc2VEYW1hZ2UgPSBmdW5jdGlvbigpe1xuICAgIGlmKHRoaXMuZGFtYWdlIDwgNCl7XG4gICAgICAgIHRoaXMuZGFtYWdlICs9IDE7XG4gICAgfVxuXG4gICAgaWYodGhpcy5kYW1hZ2UgPD0gMyAmJiB0aGlzLmRhbWFnZSA+IDApe1xuICAgICAgICB0aGlzLmRhbWFnZUltYWdlLnNyYyA9ICcuLi9hc3NldHMvUE5HL0RhbWFnZS9wbGF5ZXJTaGlwMV9kYW1hZ2UnKyB0aGlzLmRhbWFnZSArICcucG5nJztcbiAgICB9XG59O1xuXG5TcGFjZXNoaXAucHJvdG90eXBlLmRlY3JlYXNlRGFtYWdlID0gZnVuY3Rpb24oKXtcbiAgICBpZih0aGlzLmRhbWFnZSA+IDApe1xuICAgICAgICB0aGlzLmRhbWFnZSAtPSAxO1xuICAgIH1cblxuICAgIGlmKHRoaXMuZGFtYWdlIDw9IDMgJiYgdGhpcy5kYW1hZ2UgPiAwKXtcbiAgICAgICAgdGhpcy5kYW1hZ2VJbWFnZS5zcmMgPSAnLi4vYXNzZXRzL1BORy9EYW1hZ2UvcGxheWVyU2hpcDFfZGFtYWdlJysgdGhpcy5kYW1hZ2UgKyAnLnBuZyc7XG4gICAgfVxufTtcblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IE1pY2hpZWwgb24gMTYvMTIvMjAxNS5cbiAqL1xuLyoqXG4gKiBDcmVhdGVkIGJ5IGp1c3Rpam5kZXBvdmVyIG9uIDE2LzEyLzE1LlxuICovXG5cblxuKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGRpc3BsYXlTZXJ2aWNlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy9Mb2dpbiBDb250cm9sbGVyXG4gICAgICAgIHZhciBMQ1Nob3cgPSB0cnVlO1xuICAgICAgICAvL1BsYXkgY29udHJvbGxlclxuICAgICAgICB2YXIgUENTaG93ID0gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgZ2V0TENTaG93OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHJldHVybiBMQ1Nob3c7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0TENTaG93OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgTENTaG93ID0gdmFsdWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0UENTaG93OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHJldHVybiBQQ1Nob3c7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0UENTaG93OiBmdW5jdGlvbih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgUENTaG93ID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmZhY3RvcnkoJ2Rpc3BsYXlTZXJ2aWNlJywgW2Rpc3BsYXlTZXJ2aWNlXSk7XG59KSgpOyIsIi8qKlxuICogQ3JlYXRlZCBieSBqdXN0aWpuZGVwb3ZlciBvbiAxNy8xMi8xNS5cbiAqL1xuXG4oZnVuY3Rpb24oKXtcbiAgICB2YXIgcGxheWVyU2VydmljZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vTG9naW4gQ29udHJvbGxlclxuICAgICAgICB2YXIgcGxheWVycyA9IFtdO1xuXG4gICAgICAgIHJldHVybntcbiAgICAgICAgICAgIGdldFBsYXllcnM6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllcnM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0UGxheWVyczogZnVuY3Rpb24ocGxheWVyc0FycmF5KXtcbiAgICAgICAgICAgICAgICBwbGF5ZXJzID0gcGxheWVyc0FycmF5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5mYWN0b3J5KCdwbGF5ZXJTZXJ2aWNlJywgW3BsYXllclNlcnZpY2VdKTtcbn0pKCk7IiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGp1c3Rpam5kZXBvdmVyIG9uIDA5LzEyLzE1LlxuICovXG5cbihmdW5jdGlvbigpe1xuXG4gICAgdmFyIHNvY2tldFNlcnZpY2UgPSBmdW5jdGlvbigkcm9vdFNjb3BlKXtcbiAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgICAgIC8vcHJpdmF0ZVxuICAgICAgICB2YXIgc29ja2V0ID0gaW8uY29ubmVjdCh3aW5kb3cubG9jYXRpb24uaG9zdCk7XG4gICAgICAgIC8vZnVuY3Rpb25zXG4gICAgICAgIHZhciBvbiA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBzb2NrZXQub24oZXZlbnROYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShzb2NrZXQsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGVtaXQgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBkYXRhLCBjYWxsYmFjaykge1xuICAgICAgICAgICAgc29ja2V0LmVtaXQoZXZlbnROYW1lLCBkYXRhLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHNvY2tldCwgYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWNcbiAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgb246IG9uLFxuICAgICAgICAgICAgZW1pdDogZW1pdCxcbiAgICAgICAgICAgIHNvY2tldDogc29ja2V0XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHBcIikuZmFjdG9yeShcInNvY2tldFNlcnZpY2VcIiwgW1wiJHJvb3RTY29wZVwiLCBzb2NrZXRTZXJ2aWNlXSk7XG5cbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
